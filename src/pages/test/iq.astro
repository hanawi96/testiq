---
import BaseLayout from '../../layouts/BaseLayout.astro';
import IQTestWrapper from '../../components/tests/types/iq/IQTestWrapper.tsx';
import { testConfig, iqQuestions } from '../../data/iqQuestions';

// Simple locale function
const getLocale = (lang: string) => ({
  meta: {
    site_name: 'IQ Test Pro'
  }
});

const locale = getLocale('vi');
---

<BaseLayout
  title={`${testConfig.title} - ${locale.meta.site_name}`}
  description={testConfig.description}
>
  <!-- Ph·∫ßn hi·ªÉn th·ªã intro ban ƒë·∫ßu -->
  <div id="intro-section">
    <div class="max-w-4xl mx-auto text-center py-20">
      <div class="bg-white rounded-3xl shadow-xl p-12 border border-gray-100">
        <div class="mb-8">
          <h1 class="text-4xl font-bold text-gray-900 mb-4 font-display">
            Test IQ Chuy√™n Nghi·ªáp
          </h1>
          <p class="text-xl text-gray-600 mb-6">
            ƒê√°nh gi√° tr√≠ tu·ªá v·ªõi {iqQuestions.length} c√¢u h·ªèi trong {Math.floor(testConfig.timeLimit / 60)} ph√∫t
          </p>
          
          <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
            <div class="bg-blue-50 p-6 rounded-2xl">
              <div class="text-3xl mb-2">üß†</div>
              <h3 class="font-semibold text-gray-900 mb-1">T∆∞ duy logic</h3>
              <p class="text-sm text-gray-600">Ki·ªÉm tra kh·∫£ nƒÉng suy lu·∫≠n v√† ph√¢n t√≠ch</p>
            </div>
            <div class="bg-green-50 p-6 rounded-2xl">
              <div class="text-3xl mb-2">‚è±Ô∏è</div>
              <h3 class="font-semibold text-gray-900 mb-1">T·ªëc ƒë·ªô x·ª≠ l√Ω</h3>
              <p class="text-sm text-gray-600">ƒêo l∆∞·ªùng kh·∫£ nƒÉng ph·∫£n x·∫° nhanh</p>
            </div>
            <div class="bg-purple-50 p-6 rounded-2xl">
              <div class="text-3xl mb-2">üìä</div>
              <h3 class="font-semibold text-gray-900 mb-1">Ph√¢n t√≠ch chi ti·∫øt</h3>
              <p class="text-sm text-gray-600">B√°o c√°o k·∫øt qu·∫£ chuy√™n s√¢u</p>
            </div>
          </div>
        </div>
        
        <button 
          id="start-test-btn"
          class="inline-flex items-center px-8 py-4 text-lg font-semibold text-white bg-gradient-to-r from-primary-600 to-blue-600 rounded-xl shadow-lg hover:shadow-xl transition-all duration-300"
        >
          B·∫Øt ƒê·∫ßu Test Ngay
        </button>
        
        <p class="text-sm text-gray-500 mt-4">
          M·∫πo: S·ª≠ d·ª•ng ph√≠m s·ªë 1-4 ƒë·ªÉ ch·ªçn ƒë√°p √°n nhanh ch√≥ng
        </p>
      </div>
    </div>
  </div>

  <!-- Ph·∫ßn test s·∫Ω ƒë∆∞·ª£c hi·ªÉn th·ªã sau khi nh·∫•n n√∫t b·∫Øt ƒë·∫ßu -->
  <div id="test-section" style="display: none;">
    <IQTestWrapper 
      questions={iqQuestions} 
      timeLimit={testConfig.timeLimit}
      startImmediately={true}
      client:only="react"
    />
  </div>

  <script>
    // Script ƒë·ªÉ x·ª≠ l√Ω hi·ªÉn th·ªã test khi ng∆∞·ªùi d√πng nh·∫•n n√∫t b·∫Øt ƒë·∫ßu
    document.addEventListener('DOMContentLoaded', function() {
      // X√≥a tr·∫°ng th√°i c≈© (n·∫øu c√≥)
      sessionStorage.removeItem('iq_test_started');
      
      // Th√™m event listener cho n√∫t b·∫Øt ƒë·∫ßu test
      const startButton = document.getElementById('start-test-btn');
      if (startButton) {
        startButton.addEventListener('click', function() {
          // ·∫®n ph·∫ßn intro
          document.getElementById('intro-section').style.display = 'none';
          
          // Hi·ªÉn th·ªã ph·∫ßn test
          document.getElementById('test-section').style.display = 'block';
        });
      }
    });
  </script>
</BaseLayout>