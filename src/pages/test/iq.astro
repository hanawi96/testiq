---
import BaseLayout from '../../layouts/BaseLayout.astro';
import { testConfig, iqQuestions } from '../../data/iqQuestions';
import IQTestWrapper from '../../components/tests/types/iq/IQTestWrapper.tsx';

// Simple locale function
const getLocale = (lang: string) => ({
  meta: {
    site_name: 'IQ Test Pro'
  }
});

const locale = getLocale('vi');
---

<BaseLayout
  title={`${testConfig.title} - ${locale.meta.site_name}`}
  description={testConfig.description}
>
  <div id="intro-container">
    <div class="max-w-4xl mx-auto text-center py-20">
      <div class="bg-white rounded-3xl shadow-xl p-12 border border-gray-100">
        <div class="mb-8">
          <h1 class="text-4xl font-bold text-gray-900 mb-4 font-display">
            Test IQ ChuyÃªn Nghiá»‡p
          </h1>
          <p class="text-xl text-gray-600 mb-6">
            ÄÃ¡nh giÃ¡ trÃ­ tuá»‡ vá»›i {iqQuestions.length} cÃ¢u há»i trong {Math.floor(testConfig.timeLimit / 60)} phÃºt
          </p>
          
          <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
            <div class="bg-blue-50 p-6 rounded-2xl">
              <div class="text-3xl mb-2">ğŸ§ </div>
              <h3 class="font-semibold text-gray-900 mb-1">TÆ° duy logic</h3>
              <p class="text-sm text-gray-600">Kiá»ƒm tra kháº£ nÄƒng suy luáº­n vÃ  phÃ¢n tÃ­ch</p>
            </div>
            <div class="bg-green-50 p-6 rounded-2xl">
              <div class="text-3xl mb-2">â±ï¸</div>
              <h3 class="font-semibold text-gray-900 mb-1">Tá»‘c Ä‘á»™ xá»­ lÃ½</h3>
              <p class="text-sm text-gray-600">Äo lÆ°á»ng kháº£ nÄƒng pháº£n xáº¡ nhanh</p>
            </div>
            <div class="bg-purple-50 p-6 rounded-2xl">
              <div class="text-3xl mb-2">ğŸ“Š</div>
              <h3 class="font-semibold text-gray-900 mb-1">PhÃ¢n tÃ­ch chi tiáº¿t</h3>
              <p class="text-sm text-gray-600">BÃ¡o cÃ¡o káº¿t quáº£ chuyÃªn sÃ¢u</p>
            </div>
          </div>
        </div>
        
        <button 
          id="start-test-btn"
          class="inline-flex items-center px-8 py-4 text-lg font-semibold text-white bg-gradient-to-r from-primary-600 to-blue-600 rounded-xl shadow-lg hover:shadow-xl transition-all duration-300"
        >
          Báº¯t Äáº§u Test Ngay
        </button>
        
        <p class="text-sm text-gray-500 mt-4">
          Máº¹o: Sá»­ dá»¥ng phÃ­m sá»‘ 1-4 Ä‘á»ƒ chá»n Ä‘Ã¡p Ã¡n nhanh chÃ³ng
        </p>
      </div>
    </div>
  </div>
  
  <div id="test-container" class="hidden">
    <IQTestWrapper 
      questions={iqQuestions} 
      timeLimit={testConfig.timeLimit}
      startImmediately={false}
      client:load
    />
  </div>

  <script>
    // Script Ä‘á»ƒ xá»­ lÃ½ viá»‡c báº¯t Ä‘áº§u test
    document.addEventListener('DOMContentLoaded', () => {
      const startButton = document.getElementById('start-test-btn');
      const introContainer = document.getElementById('intro-container');
      const testContainer = document.getElementById('test-container');
      
      // Kiá»ƒm tra náº¿u Ä‘Ã£ báº¯t Ä‘áº§u test trÆ°á»›c Ä‘Ã³ (khi refresh trang)
      if (sessionStorage.getItem('iq_test_started') === 'true') {
        if (introContainer && testContainer) {
          introContainer.classList.add('hidden');
          testContainer.classList.remove('hidden');
        }
      }
      
      // ThÃªm sá»± kiá»‡n click cho nÃºt báº¯t Ä‘áº§u test
      if (startButton && introContainer && testContainer) {
        startButton.addEventListener('click', () => {
          // áº¨n pháº§n giá»›i thiá»‡u
          introContainer.classList.add('hidden');
          // Hiá»ƒn thá»‹ pháº§n test
          testContainer.classList.remove('hidden');
          
          // LÆ°u tráº¡ng thÃ¡i Ä‘Ã£ báº¯t Ä‘áº§u test vÃ o sessionStorage
          sessionStorage.setItem('iq_test_started', 'true');
          
          // Cuá»™n lÃªn Ä‘áº§u trang
          window.scrollTo(0, 0);
        });
      }
    });
  </script>
</BaseLayout>